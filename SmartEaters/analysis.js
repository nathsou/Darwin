(()=>{"use strict";var t={283:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function r(t){try{a(s.next(t))}catch(t){o(t)}}function h(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,h)}a((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=i(843);document.body.style.padding="0",document.body.style.margin="0",document.addEventListener("DOMContentLoaded",(()=>s(void 0,void 0,void 0,(function*(){if(-1!==location.search.indexOf("?b=")){const t=location.search.split("?b=")[1],e=yield n.EaterAnalysis.fromBlob(t),i=e.domElement;i.style.display="block",document.body.appendChild(i),e.start()}}))))},598:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Eater=void 0;const s=i(835);e.Eater=class{constructor(t,e,i){this.pos=t,this.angle=e,this.chromosomeIdx=i}getChromosomeIdx(){return this.chromosomeIdx}getPosition(){return this.pos}setPosition(t){this.pos=t}getAngle(){return this.angle}setAngle(t){this.angle=t%s.MathUtils.TWO_PI}}},843:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function r(t){try{a(s.next(t))}catch(t){o(t)}}function h(t){try{a(s.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,h)}a((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.EaterAnalysis=void 0;const n=i(835),o=i(157),r=i(598);class h{constructor(t,e){if(this.paused=!0,this.params=t,this.brain=new Function(...e.args,e.body),this.cnv=document.createElement("canvas"),this.cnv.width=window.innerWidth,this.cnv.height=window.innerHeight,null===this.cnv.getContext("2d"))throw new Error("Could not get a 2d canvas context");this.foodPos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]),window.addEventListener("resize",(()=>this.onResize())),this.eater=new r.Eater(o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]),Math.random()*Math.PI*2,0)}onResize(){this.cnv.width=window.innerWidth,this.cnv.height=window.innerHeight,(this.cnv.width<this.foodPos.x||this.cnv.height<this.foodPos.y)&&(this.foodPos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]))}update(){this.tick(),this.render(),this.paused||requestAnimationFrame(this.update)}pause(){this.paused=!0}start(){this.paused=!1,this.update()}tick(){this.eater.getPosition().dist(this.foodPos)<=(this.params.eaterSize+this.params.foodSize)/2&&(this.foodPos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height])),this.eater.foodDir=this.foodPos.sub(this.eater.getPosition().normalize());const[t,e]=this.brain([Math.cos(this.eater.getAngle()),Math.sin(this.eater.getAngle()),this.eater.foodDir.x,this.eater.foodDir.y]),i=n.MathUtils.clamp(t-e,-this.params.maxTurnRate,this.params.maxTurnRate);this.eater.setAngle(this.eater.getAngle()+i),this.eater.lookat=new o.Vector2D(Math.cos(this.eater.getAngle()),Math.sin(this.eater.getAngle())),this.eater.getPosition().plus(this.eater.lookat.times(this.params.maxSpeed)),this.params.wrapBorders?(this.eater.getPosition().x>this.cnv.width&&(this.eater.getPosition().x=0),this.eater.getPosition().x<0&&(this.eater.getPosition().x=this.cnv.width),this.eater.getPosition().y>this.cnv.height&&(this.eater.getPosition().y=0),this.eater.getPosition().y<0&&(this.eater.getPosition().y=this.cnv.height)):(this.eater.getPosition().x>this.cnv.width&&(this.eater.getPosition().x=this.cnv.width),this.eater.getPosition().x<0&&(this.eater.getPosition().x=0),this.eater.getPosition().y>this.cnv.height&&(this.eater.getPosition().y=this.cnv.height),this.eater.getPosition().y<0&&(this.eater.getPosition().y=0))}render(){this.ctx.clearRect(0,0,this.cnv.width,this.cnv.height),this.drawFood(),this.drawEeater()}drawFood(){const t=this.params.foodSize;this.ctx.fillStyle="rgb(52, 73, 94)",this.ctx.beginPath(),this.ctx.fillRect(this.foodPos.x-t/2,this.foodPos.y-t/2,t,t),this.ctx.fill()}drawEeater(){this.ctx.fillStyle="rgb(22, 160, 133)",this.ctx.beginPath();const t=this.eater.lookat.times(this.params.eaterSize).add(this.eater.getPosition()),e=t.sub(this.eater.getPosition()).angle(),i=Math.PI/1.3,s=new o.Vector2D(Math.cos(e+i),Math.sin(e+i)),n=new o.Vector2D(Math.cos(e-i),Math.sin(e-i)),r=this.eater.getPosition().add(s.times(this.params.eaterSize)),h=this.eater.getPosition().add(n.times(this.params.eaterSize));this.ctx.moveTo(r.x,r.y),this.ctx.lineTo(t.x,t.y),this.ctx.lineTo(h.x,h.y),this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.moveTo(this.eater.getPosition().x,this.eater.getPosition().y);const a=this.eater.getPosition().add(this.eater.foodDir.times(2*this.params.eaterSize));this.ctx.lineTo(a.x,a.y),this.ctx.stroke()}get domElement(){return this.cnv}static fromBlob(t){return new Promise(((e,i)=>s(this,void 0,void 0,(function*(){try{const i=JSON.parse(yield(yield fetch(t.toString())).text());e(new h(i.params,i.brain))}catch(t){i(t)}}))))}}e.EaterAnalysis=h},835:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.MathUtils=void 0,(i=e.MathUtils||(e.MathUtils={})).clamp=(t,e,i)=>t>=e&&t<=i?t:t<e?e:i,i.map=(t,e,i,s,n)=>(t-e)/(i-e)*(n-s)+s,i.TWO_PI=2*Math.PI},157:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2D=void 0;class i{constructor(t,e){this.x=t,this.y=e}add(t){return new i(this.x+t.x,this.y+t.y)}sub(t){return new i(this.x-t.x,this.y-t.y)}plus(t){this.x+=t.x,this.y+=t.y}minus(t){this.x-=t.x,this.y-=t.y}dot(t){return this.x*t.x+this.y*t.y}hadamard(t){return t instanceof i?new i(this.x*t.x,this.y*t.y):new i(this.x*t[0],this.y*t[1])}norm(){return Math.pow(this.dot(this),.5)}normSq(){return this.dot(this)}times(t){return new i(this.x*t,this.y*t)}normalize(){return this.times(1/this.norm())}dist(t){return this.sub(t).norm()}distSq(t){return this.sub(t).normSq()}map(t){return new i(t(this.x),t(this.y))}angle(){return Math.atan2(this.y,this.x)}toArray(){return[this.x,this.y]}fromArray(t){return new i(t[0],t[1])}static fill(t){return new i(t,t)}static zeroes(){return i.fill(0)}static ones(){return i.fill(1)}static rand(){return new i(Math.random(),Math.random())}static clone(t){return new i(t.x,t.y)}}e.Vector2D=i}},e={};!function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,i),o.exports}(283)})();