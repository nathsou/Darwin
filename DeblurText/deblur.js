(()=>{"use strict";var t={446:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Chromosome=void 0;class s{constructor(t,e,s){this.genes=[],this.fitness=0,this.randGene=e,this.randNum=s,this.genes=t,this.length=t.length}static generate(t,e,n){const o=[];for(let s=0;s<t;s++)o.push(e());return new s(o,e,n)}getFitness(){return this.fitness}setFitness(t){this.fitness=t}compare(t){let e=0;for(let s=0;s<Math.min(this.length,t.length);s++)e+=this.genes[s]!==t.genes[s]?1:0;return e}mutateWith(t=1/this.length,e){e(this,t)}crossoverWith(t,e){return e(this,t)}setGenes(t){this.genes=[...t]}getGenes(){return this.genes}copy(t){this.genes=t.genes.slice(),this.length=t.length,this.randGene=t.randGene,this.fitness=t.fitness}clone(){const t=s.generate(this.length,this.randGene,this.randNum);return t.copy(this),t}randomGene(){return this.randGene()}randomNumber(){return this.randNum()}}e.Chromosome=s},348:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.crossoverMethod=void 0,e.crossoverMethod={singlePoint:(t,e)=>{const s=Math.floor(t.randomNumber()*t.getGenes().length);return[[...t.getGenes().slice(0,s),...e.getGenes().slice(s)],[...e.getGenes().slice(0,s),...t.getGenes().slice(s)]]},twoPoint:(t,e)=>{const s=[],n=[],o=t.getGenes(),a=e.getGenes(),r=t.getGenes().length;let i=Math.floor(t.randomNumber()*r),h=Math.floor(t.randomNumber()*r);i>h&&([i,h]=[h,i]);for(let t=0;t<r;t++)s.push(t<i?o[t]:t<h?a[t]:o[t]),n.push(t<i?a[t]:t<h?o[t]:a[t]);return[s,n]},uniform:(t,e)=>{const s=[],n=[],o=t.getGenes(),a=e.getGenes(),r=t.getGenes().length;for(let e=0;e<r;e++){const r=t.randomNumber()<.5;s.push(r?a[e]:o[e]),n.push(r?o[e]:a[e])}return[s,n]},halfUniform:(t,e)=>{let s=[],n=[];const o=t.getGenes(),a=e.getGenes(),r=t.getGenes().length,i=[];for(let t=0;t<r;t++)o[t]!==a[t]&&i.push(t);const h=i.length;s=o.slice(),n=a.slice();for(let e=0;e<h/2;e++){let e=Math.floor(t.randomNumber()*i.length);s[i[e]]=a[i[e]],n[i[e]]=o[i[e]],i.splice(e,1)}return[s,n]},ordered:(t,e)=>{const s=[],n=[],o=t.getGenes(),a=e.getGenes(),r=t.getGenes().length;let i=Math.floor(t.randomNumber()*r),h=Math.floor(t.randomNumber()*r),l=i;i=Math.min(i,h),h=Math.max(l,h);for(let t=i;t<h;t++)s[t]=a[t],n[t]=o[t];for(let t=0;t<r;t++){if(-1===s.indexOf(o[t]))s[t]=o[t];else for(let e=0;e<r;e++)-1===s.indexOf(o[e])&&(s[t]=o[e]);if(-1===n.indexOf(a[t]))n[t]=a[t];else for(let e=0;e<a.length;e++)-1===n.indexOf(a[e])&&(n[t]=a[e])}return[s,n]}}},803:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Darwin=void 0;const n=s(446),o=s(348),a=s(666),r=s(675);e.Darwin=class{constructor(t){this.population=[],this.statsNeedUpdate=!0,this.generation=0,this.params=Object.assign({crossoverRate:.7,mutationRate:1/t.populationSize,crossoverMethod:o.crossoverMethod.singlePoint,mutationMethod:a.mutationMethod.flip,eliteCount:Math.ceil(t.populationSize/25),eliteCopies:1,randomNumber:Math.random},t);for(let e=0;e<t.populationSize;e++){const t=n.Chromosome.generate(this.params.chromosomeLength,this.params.randomGene,this.params.randomNumber);this.population.push(t)}this.stats={fittest:this.population[0],averageFitness:0,totalFitness:0,fittestIndex:0}}duplicateElite(t){const{eliteCount:e,eliteCopies:s}=this.params;if(e>0){const n=this.getTopChromosomes(e);t.push(...n);for(let o=0;o<e;o++)for(let e=0;e<s;e++)t.push(n[o].clone())}}crossover(t){const{populationSize:e,crossoverRate:s,crossoverMethod:o,randomGene:a,randomNumber:r}=this.params;for(;t.length<e;)if(this.params.randomNumber()<s){const e=this.getRandomChromosome(),s=this.getRandomChromosome(),[i,h]=e.crossoverWith(s,o);t.push(new n.Chromosome(i,a,r),new n.Chromosome(h,a,r))}this.params.populationSize%2==1&&t.pop()}mutate(t){for(const e of t)e.mutateWith(this.params.mutationRate,this.params.mutationMethod)}updateFitness(t){for(let e=0;e<this.population.length;e++){const s=this.population[e];s.setFitness(t(s.getGenes(),e))}}mate(){const t=[];this.duplicateElite(t),this.crossover(t),this.mutate(t),this.population=t,this.generation+=1,this.statsNeedUpdate=!0}getPopulation(){return this.population}getChromosomeAt(t){return this.population[t]}getRandomChromosome(){if(this.updateStats(),0===this.stats.totalFitness)return this.population[Math.floor(this.params.randomNumber()*this.population.length)];const t=this.params.randomNumber()*this.stats.totalFitness;let e=0;for(let s=0;s<this.population.length;s++)if(e+=this.population[s].getFitness(),e>t)return this.population[s];return this.population[0]}getTopChromosomes(t){return r.selectKBest(this.population,t)}getParams(){return this.params}getGeneration(){return this.generation}getStats(){return this.stats}updateStats(t=!1){if(t||this.statsNeedUpdate){let t=0,e=0,s=0;for(let n=0;n<this.population.length;n++){const o=this.population[n].getFitness();t+=o,o>e&&(e=o,s=n)}this.stats.totalFitness=t,this.stats.averageFitness=t/this.params.populationSize,this.stats.fittest=this.population[s].clone(),this.stats.fittestIndex=s,this.statsNeedUpdate=!1}return this.stats}}},827:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Deblurrer=e.renderBlurredText=void 0;const n=s(348),o=s(803),a=s(666),r=s(147),i=s(799);e.renderBlurredText=(t,e,s,n)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height),t.font=s,t.filter=`blur(${n}px)`,t.fillText(e,2,30)},e.Deblurrer=class{constructor(t){this.bestFitness=0,this.bestText="",this.memo=new Map,this.isRunning=!1,this.update=t=>{this.params=t,this.targetImageData=this.renderTarget(),this.population=new o.Darwin(this.updateDarwinParams()),this.bestFitness=0,this.bestText="",this.generateContexts()},this.targetContext=i.createCanvas({},{border:"1px solid black"})[1],this.update(t)}update(t){this.isRunning=!1,this.params=t,this.renderTarget(),this.updateDarwinParams(),this.generateContexts(),this.population=new o.Darwin(this.darwinParams),this.targetImageData=this.renderTarget()}updateDarwinParams(){return this.darwinParams={populationSize:this.params.populationSize,randomGene:r.randChar,chromosomeLength:this.params.target.length,mutationMethod:a.mutationMethod.flip,crossoverMethod:n.crossoverMethod.twoPoint,mutationRate:.1,crossoverRate:.9},this.darwinParams}renderTarget(){const{width:t}=((t,e)=>{const[s,n]=i.createCanvas({width:1e3,height:100});return n.font=e,n.measureText(t)})(this.params.target,this.params.font);return this.width=t+5,this.height=35,this.targetContext.canvas.width=this.width,this.targetContext.canvas.height=this.height,e.renderBlurredText(this.targetContext,this.params.target,this.params.font,this.params.blurRadius),this.targetContext.getImageData(0,0,this.width,this.height)}generateContexts(){this.contexts=[];for(let t=0;t<this.params.populationSize;t++)this.contexts.push(i.createCanvas({width:this.width,height:this.height},{border:"1px solid black"})[1])}tick(){this.memo.size>1e4&&this.memo.clear(),this.population.updateFitness(((t,s)=>{var n;const o=this.contexts[s],a=t.join("");if(e.renderBlurredText(o,a,this.params.font,this.params.blurRadius),!this.memo.has(a)){const t=((t,e)=>{let s=0;for(let n=0;n<t.data.length;n+=4){const o=Math.abs(e.data[n+3]-t.data[n+3]);s+=Math.pow(255-o,2)}return Math.pow(1e3,s/(Math.pow(255,2)*t.data.length/4))})(o.getImageData(0,0,this.width,this.height),this.targetImageData);t>this.bestFitness&&(this.bestFitness=t,this.bestText=a,console.log(this.bestText,this.bestFitness)),this.memo.set(a,t)}return null!==(n=this.memo.get(a))&&void 0!==n?n:0})),this.params.onTick&&this.params.onTick(),this.population.mate()}start(){this.isRunning=!0;const t=()=>{this.tick(),this.isRunning&&this.bestFitness<1e3&&requestAnimationFrame(t.bind(this))};t()}getCurrentBest(){return{string:this.bestText,fitness:this.bestFitness}}getTargetContext(){return this.targetContext}getPopulation(){return this.population}getContexts(){return this.contexts}}},147:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randChar=e.alphabet=void 0,e.alphabet=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","?","!",".","#","@","&","*","$","%","+","-","/","=","0","1","2","3","4","5","6","7","8","9","(",")",",","'",'"',":","_","-"],e.randChar=function(){return e.alphabet[Math.floor(Math.random()*e.alphabet.length)]}},799:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.namedInput=e.appendChildren=e.createCanvas=e.h=void 0,e.h=(t,e={},s={})=>{const n=document.createElement(t);for(const[t,s]of Object.entries(e))n[t]=s;for(const t in s){const e=s[t];void 0!==e&&(n.style[t]=e)}return n},e.createCanvas=(t={},s={})=>{const n=e.h("canvas",t,s),o=n.getContext("2d");if(null===o)throw new Error("Could not create a 2d canvas");return[n,o]},e.appendChildren=(t,e)=>{for(const s of e)t.appendChild(s);return t},e.namedInput=(t,s)=>{const n=e.h("input",s),o=e.h("span",{textContent:"range"===s.type?`${t} : ${n.value}`:t}),a=e.appendChildren(e.h("div"),[o,n]);return n.addEventListener("change",(()=>{"range"===s.type&&(o.textContent=`${t} : ${n.value}`)})),{elem:a,value:()=>n.value}}},666:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.mutationMethod=void 0,e.mutationMethod={flip:(t,e)=>{const s=t.getGenes(),n=s.length;for(let o=0;o<n;o++)t.randomNumber()<e&&(s[o]=t.randomGene())},swap:(t,e)=>{const s=t.getGenes(),n=s.length;for(let o=0;o<n;o++)if(t.randomNumber()<e){const t=Math.floor(Math.random()*n);[s[o],s[t]]=[s[t],s[o]]}}}},675:(t,e)=>{function s(t,e=0,o=t.length-1){const a=t[Math.floor((e+o)/2)].getFitness();if(e<o){const r=n(t,e,o,a);s(t,e,r-1),s(t,r,o)}}function n(t,e,s,n){for(;e<=s;){for(;t[e].getFitness()>n;)e++;for(;t[s].getFitness()<n;)s--;e<=s&&([t[e],t[s]]=[t[s],t[e]],e++,s--)}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.selectKBest=void 0,e.selectKBest=function(t,e){return function(t,e,o=0,a=t.length-1){const r=t[Math.floor((o+a)/2)].getFitness();if(o<a){const i=n(t,o,a,r);s(t,o,i-1),i<e&&s(t,i,a)}}(t,e),t.slice(0,e)}}},e={};function s(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,s),a.exports}(()=>{const t=s(799),e=s(827),n=(()=>{const s=t.namedInput("text",{type:"text",value:"DARWIN",onchange:u,onkeyup:u}),n=t.namedInput("blur radius",{type:"range",min:"0",max:"10",step:"1",value:"4",onchange:u}),o=t.namedInput("font size",{type:"range",min:"10",max:"40",step:"1",value:"30",onchange:u}),a=t.namedInput("population",{type:"range",min:"5",max:"1000",step:"1",value:"200",onchange:u}),r=t.h("p",{textContent:"generation: 0"}),i=t.h("p",{textContent:"best: "},{fontSize:"24px"}),h=()=>{r.textContent=`generation: ${l.getPopulation().getGeneration()}`,i.textContent=`best: ${l.getCurrentBest().string}`},l=new e.Deblurrer({populationSize:parseInt(a.value()),target:s.value(),blurRadius:parseInt(n.value()),font:`${o.value()}px sans-serif`,onTick:h});function u(){l.update({populationSize:parseInt(a.value()),target:s.value(),blurRadius:parseInt(n.value()),font:`${o.value()}px sans-serif`,onTick:h}),l.tick(),m()}const p=t.appendChildren(t.h("div",{},{display:"flex",flexWrap:"wrap"}),l.getContexts().map((t=>t.canvas))),d=t.appendChildren(t.h("div"),[l.getTargetContext().canvas,s.elem,n.elem,o.elem,a.elem,r,i,t.h("button",{textContent:"start",onclick:()=>{l.start()}}),p]),m=()=>{console.log("rerender",l.getContexts().length),p.innerHTML="",t.appendChildren(p,l.getContexts().map((t=>t.canvas)))};return u(),d})();document.body.appendChild(n)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGFybGVzLmRhcndpbi8uL3NyYy9DaHJvbW9zb21lLnRzIiwid2VicGFjazovL2NoYXJsZXMuZGFyd2luLy4vc3JjL0Nyb3Nzb3Zlck1ldGhvZHMudHMiLCJ3ZWJwYWNrOi8vY2hhcmxlcy5kYXJ3aW4vLi9zcmMvRGFyd2luLnRzIiwid2VicGFjazovL2NoYXJsZXMuZGFyd2luLy4vc3JjL0RlbW9zL0RlYmx1clRleHQvRGVibHVyLnRzIiwid2VicGFjazovL2NoYXJsZXMuZGFyd2luLy4vc3JjL0RlbW9zL2NvbW1vbi9UZXh0LnRzIiwid2VicGFjazovL2NoYXJsZXMuZGFyd2luLy4vc3JjL0RlbW9zL2NvbW1vbi9VdGlscy50cyIsIndlYnBhY2s6Ly9jaGFybGVzLmRhcndpbi8uL3NyYy9NdXRhdGlvbk1ldGhvZC50cyIsIndlYnBhY2s6Ly9jaGFybGVzLmRhcndpbi8uL3NyYy9VdGlscy50cyIsIndlYnBhY2s6Ly9jaGFybGVzLmRhcndpbi93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9jaGFybGVzLmRhcndpbi8uL3NyYy9EZW1vcy9EZWJsdXJUZXh0L01haW4udHMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJDaHJvbW9zb21lIiwiZ2VuZXMiLCJyYW5kb21HZW5lIiwicmFuZG9tTnVtYmVyIiwidGhpcyIsImZpdG5lc3MiLCJyYW5kR2VuZSIsInJhbmROdW0iLCJsZW5ndGgiLCJjb3VudCIsImkiLCJwdXNoIiwiZiIsImJvYiIsIk1hdGgiLCJtaW4iLCJtdXRhdGlvblJhdGUiLCJtdXRhdGVGbiIsImNyb3Nzb3ZlckZuIiwic2xpY2UiLCJjbG9uZSIsImdlbmVyYXRlIiwiY29weSIsImNyb3Nzb3Zlck1ldGhvZCIsInNpbmdsZVBvaW50IiwiYWxpY2UiLCJwIiwiZmxvb3IiLCJnZXRHZW5lcyIsInR3b1BvaW50IiwiYjEiLCJiMiIsImFsaWNlc0dlbmVzIiwiYm9ic0dlbmVzIiwiYWxpY2VDaHJvbW9MZW5ndGgiLCJwMSIsInAyIiwidW5pZm9ybSIsInN3YXAiLCJoYWxmVW5pZm9ybSIsImRpZmZCaXRzIiwiTiIsImlkeCIsInNwbGljZSIsIm9yZGVyZWQiLCJpbmYiLCJzdXAiLCJ0bXAiLCJtYXgiLCJpbmRleE9mIiwiaiIsIkRhcndpbiIsIkNocm9tb3NvbWVfMSIsIkNyb3Nzb3Zlck1ldGhvZHNfMSIsIk11dGF0aW9uTWV0aG9kXzEiLCJVdGlsc18xIiwicGFyYW1zIiwicG9wdWxhdGlvbiIsInN0YXRzTmVlZFVwZGF0ZSIsImdlbmVyYXRpb24iLCJhc3NpZ24iLCJjcm9zc292ZXJSYXRlIiwicG9wdWxhdGlvblNpemUiLCJtdXRhdGlvbk1ldGhvZCIsImZsaXAiLCJlbGl0ZUNvdW50IiwiY2VpbCIsImVsaXRlQ29waWVzIiwicmFuZG9tIiwiY2hyb21vIiwiY2hyb21vc29tZUxlbmd0aCIsInN0YXRzIiwiZml0dGVzdCIsImF2ZXJhZ2VGaXRuZXNzIiwidG90YWxGaXRuZXNzIiwiZml0dGVzdEluZGV4IiwibmV3UG9wdWxhdGlvbiIsImVsaXRlIiwiZ2V0VG9wQ2hyb21vc29tZXMiLCJtdW0iLCJnZXRSYW5kb21DaHJvbW9zb21lIiwiZGFkIiwiYmFieTEiLCJiYWJ5MiIsImNyb3Nzb3ZlcldpdGgiLCJwb3AiLCJjIiwibXV0YXRlV2l0aCIsImZpdG5lc3NFdmFsdWF0b3IiLCJzZXRGaXRuZXNzIiwiZHVwbGljYXRlRWxpdGUiLCJjcm9zc292ZXIiLCJtdXRhdGUiLCJpbmRleCIsInVwZGF0ZVN0YXRzIiwiciIsImFjY3VtdWxhdGVkRml0bmVzcyIsImdldEZpdG5lc3MiLCJzZWxlY3RLQmVzdCIsImZvcmNlVXBkYXRlIiwibWF4Rml0bmVzcyIsIkRlYmx1cnJlciIsInJlbmRlckJsdXJyZWRUZXh0IiwiRGFyd2luXzEiLCJUZXh0XzEiLCJjdHgiLCJ0ZXh0IiwiZm9udCIsImJsdXJSYWRpdXMiLCJjbGVhclJlY3QiLCJjYW52YXMiLCJ3aWR0aCIsImhlaWdodCIsImZpbHRlciIsImZpbGxUZXh0IiwiYmVzdEZpdG5lc3MiLCJiZXN0VGV4dCIsIm1lbW8iLCJNYXAiLCJpc1J1bm5pbmciLCJ1cGRhdGUiLCJ0YXJnZXRJbWFnZURhdGEiLCJyZW5kZXJUYXJnZXQiLCJ1cGRhdGVEYXJ3aW5QYXJhbXMiLCJnZW5lcmF0ZUNvbnRleHRzIiwidGFyZ2V0Q29udGV4dCIsImNyZWF0ZUNhbnZhcyIsImJvcmRlciIsImRhcndpblBhcmFtcyIsInJhbmRDaGFyIiwidGFyZ2V0IiwiXyIsIm1lYXN1cmVUZXh0IiwiZ2V0SW1hZ2VEYXRhIiwiY29udGV4dHMiLCJzaXplIiwiY2xlYXIiLCJ1cGRhdGVGaXRuZXNzIiwiY2hhcnMiLCJfYSIsImpvaW4iLCJoYXMiLCJzb3VyY2UiLCJkaWZmU3VtIiwiZGF0YSIsImRpZmYiLCJhYnMiLCJwb3ciLCJldmFsRml0bmVzcyIsImNvbnNvbGUiLCJsb2ciLCJzZXQiLCJnZXQiLCJvblRpY2siLCJtYXRlIiwidGljayIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmQiLCJzdHJpbmciLCJhbHBoYWJldCIsIm5hbWVkSW5wdXQiLCJhcHBlbmRDaGlsZHJlbiIsImgiLCJuYW1lIiwicHJvcHMiLCJzdHlsZSIsImVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJwcm9wIiwiZW50cmllcyIsInJ1bGUiLCJ1bmRlZmluZWQiLCJjbnYiLCJnZXRDb250ZXh0IiwiRXJyb3IiLCJjaGlscmVuIiwiY2hpbGQiLCJhcHBlbmRDaGlsZCIsImlucHV0Iiwic3BhbiIsInRleHRDb250ZW50IiwidHlwZSIsImRpdiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbGVtIiwiY2hyb21vc29tZSIsInF1aWNrc29ydCIsImFyciIsImZyb20iLCJ0byIsInBpdm90IiwicGFydGl0aW9uIiwiYXJyYXkiLCJsZWZ0IiwicmlnaHQiLCJrIiwicmV2ZXJzZVBhcnRpYWxRdWlja3NvcnQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiRGVibHVyXzEiLCJkb21FbGVtIiwib25jaGFuZ2UiLCJvblVwZGF0ZSIsIm9ua2V5dXAiLCJzdGVwIiwiZm9udFNpemUiLCJiZXN0IiwiZGVibHVycmVyIiwiZ2V0UG9wdWxhdGlvbiIsImdldEdlbmVyYXRpb24iLCJnZXRDdXJyZW50QmVzdCIsInBhcnNlSW50IiwicmVyZW5kZXIiLCJkaXNwbGF5IiwiZmxleFdyYXAiLCJnZXRDb250ZXh0cyIsIm1hcCIsImdldFRhcmdldENvbnRleHQiLCJvbmNsaWNrIiwic3RhcnQiLCJpbm5lckhUTUwiLCJzZXR1cCIsImJvZHkiXSwibWFwcGluZ3MiOiJzQ0FDQUEsT0FBT0MsZUFBZUMsRUFBUyxhQUFjLENBQUVDLE9BQU8sSUFDdERELEVBQVFFLGdCQUFhLEVBQ3JCLE1BQU1BLEVBQ0YsWUFBWUMsRUFBT0MsRUFBWUMsR0FDM0JDLEtBQUtILE1BQVEsR0FDYkcsS0FBS0MsUUFBVSxFQUNmRCxLQUFLRSxTQUFXSixFQUNoQkUsS0FBS0csUUFBVUosRUFDZkMsS0FBS0gsTUFBUUEsRUFDYkcsS0FBS0ksT0FBU1AsRUFBTU8sT0FFeEIsZ0JBQWdCQyxFQUFPSCxFQUFVSCxHQUM3QixNQUFNRixFQUFRLEdBQ2QsSUFBSyxJQUFJUyxFQUFJLEVBQUdBLEVBQUlELEVBQU9DLElBQ3ZCVCxFQUFNVSxLQUFLTCxLQUVmLE9BQU8sSUFBSU4sRUFBV0MsRUFBT0ssRUFBVUgsR0FFM0MsYUFDSSxPQUFPQyxLQUFLQyxRQUVoQixXQUFXTyxHQUNQUixLQUFLQyxRQUFVTyxFQUduQixRQUFRQyxHQUNKLElBQUlKLEVBQVEsRUFDWixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUksS0FBS0MsSUFBSVgsS0FBS0ksT0FBUUssRUFBSUwsUUFBU0UsSUFDbkRELEdBQVNMLEtBQUtILE1BQU1TLEtBQU9HLEVBQUlaLE1BQU1TLEdBQUssRUFBSSxFQUVs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V0FBWTRHLFNBQVM1RyxFQUFXN0csU0FDaEM0RyxLQUFNLEdBQUd1RyxFQUFTbk4sdUJBQ2xCMEosV0FFSjJELEVBQVV6RCxPQUNWOEQsSUFFSixNQUFNbkYsRUFBVy9FLEVBQVEwRyxlQUFlMUcsRUFBUTJHLEVBQUUsTUFBTyxHQUFJLENBQ3pEd0QsUUFBUyxPQUNUQyxTQUFVLFNBQ1ZQLEVBQVVRLGNBQWNDLEtBQUlwSCxHQUFPQSxFQUFJSyxVQUNyQytGLEVBQVV0SixFQUFRMEcsZUFBZTFHLEVBQVEyRyxFQUFFLE9BQVEsQ0FDckRrRCxFQUFVVSxtQkFBbUJoSCxPQUM3QkosRUFBSytFLEtBQ0w3RSxFQUFXNkUsS0FDWHlCLEVBQVN6QixLQUNUM0gsRUFBZTJILEtBQ2Y5SCxFQUNBd0osRUFDQTVKLEVBQVEyRyxFQUFFLFNBQVUsQ0FDaEJtQixZQUFhLFFBQ2IwQyxRQUFTLEtBRUxYLEVBQVVZLFdBR2xCMUYsSUFFRW1GLEVBQVcsS0FDYnBFLFFBQVFDLElBQUksV0FBWThELEVBQVVRLGNBQWNwTixRQUNoRDhILEVBQVMyRixVQUFZLEdBQ3JCMUssRUFBUTBHLGVBQWUzQixFQUFVOEUsRUFBVVEsY0FBY0MsS0FBSXBILEdBQU9BLEVBQUlLLFdBRzVFLE9BREFpRyxJQUNPRixHQUVLcUIsR0FDaEIzRCxTQUFTNEQsS0FBS2pELFlBQVkyQixJIiwiZmlsZSI6ImRlYmx1ci5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5DaHJvbW9zb21lID0gdm9pZCAwO1xuY2xhc3MgQ2hyb21vc29tZSB7XG4gICAgY29uc3RydWN0b3IoZ2VuZXMsIHJhbmRvbUdlbmUsIHJhbmRvbU51bWJlcikge1xuICAgICAgICB0aGlzLmdlbmVzID0gW107XG4gICAgICAgIHRoaXMuZml0bmVzcyA9IDA7XG4gICAgICAgIHRoaXMucmFuZEdlbmUgPSByYW5kb21HZW5lO1xuICAgICAgICB0aGlzLnJhbmROdW0gPSByYW5kb21OdW1iZXI7XG4gICAgICAgIHRoaXMuZ2VuZXMgPSBnZW5lcztcbiAgICAgICAgdGhpcy5sZW5ndGggPSBnZW5lcy5sZW5ndGg7XG4gICAgfVxuICAgIHN0YXRpYyBnZW5lcmF0ZShjb3VudCwgcmFuZEdlbmUsIHJhbmRvbU51bWJlcikge1xuICAgICAgICBjb25zdCBnZW5lcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGdlbmVzLnB1c2gocmFuZEdlbmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBDaHJvbW9zb21lKGdlbmVzLCByYW5kR2VuZSwgcmFuZG9tTnVtYmVyKTtcbiAgICB9XG4gICAgZ2V0Rml0bmVzcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZml0bmVzcztcbiAgICB9XG4gICAgc2V0Rml0bmVzcyhmKSB7XG4gICAgICAgIHRoaXMuZml0bmVzcyA9IGY7XG4gICAgfVxuICAgIC8vIHJldHVybnMgdGhlIG51bWJlciBvZiBiaXRzIHdoaWNoIGFyZSBkaWZmZXJlbnQgPSBIYW1taW5nIGRpc3RhbmNlXG4gICAgY29tcGFyZShib2IpIHtcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1pbih0aGlzLmxlbmd0aCwgYm9iLmxlbmd0aCk7IGkrKykge1xuICAgICAgICAgICAgY291bnQgKz0gdGhpcy5nZW5lc1tpXSAhPT0gYm9iLmdlbmVzW2ldID8gMSA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbiAgICBtdXRhdGVXaXRoKG11dGF0aW9uUmF0ZSA9IDEgLyB0aGlzLmxlbmd0aCwgbXV0YXRlRm4pIHtcbiAgICAgICAgbXV0YXRlRm4odGhpcywgbXV0YXRpb25SYXRlKTtcbiAgICB9XG4gICAgY3Jvc3NvdmVyV2l0aChib2IsIGNyb3Nzb3ZlckZuKSB7XG4gICAgICAgIHJldHVybiBjcm9zc292ZXJGbih0aGlzLCBib2IpO1xuICAgIH1cbiAgICBzZXRHZW5lcyhnZW5lcykge1xuICAgICAgICB0aGlzLmdlbmVzID0gWy4uLmdlbmVzXTtcbiAgICB9XG4gICAgZ2V0R2VuZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdlbmVzO1xuICAgIH1cbiAgICBjb3B5KGJvYikge1xuICAgICAgICB0aGlzLmdlbmVzID0gYm9iLmdlbmVzLnNsaWNlKCk7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gYm9iLmxlbmd0aDtcbiAgICAgICAgdGhpcy5yYW5kR2VuZSA9IGJvYi5yYW5kR2VuZTtcbiAgICAgICAgdGhpcy5maXRuZXNzID0gYm9iLmZpdG5lc3M7XG4gICAgfVxuICAgIGNsb25lKCkge1xuICAgICAgICBjb25zdCBjbG9uZSA9IENocm9tb3NvbWUuZ2VuZXJhdGUodGhpcy5sZW5ndGgsIHRoaXMucmFuZEdlbmUsIHRoaXMucmFuZE51bSk7XG4gICAgICAgIGNsb25lLmNvcHkodGhpcyk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9XG4gICAgcmFuZG9tR2VuZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFuZEdlbmUoKTtcbiAgICB9XG4gICAgcmFuZG9tTnVtYmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYW5kTnVtKCk7XG4gICAgfVxufVxuZXhwb3J0cy5DaHJvbW9zb21lID0gQ2hyb21vc29tZTtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jcm9zc292ZXJNZXRob2QgPSB2b2lkIDA7XG5leHBvcnRzLmNyb3Nzb3Zlck1ldGhvZCA9IHtcbiAgICBzaW5nbGVQb2ludDogKGFsaWNlLCBib2IpID0+IHtcbiAgICAgICAgY29uc3QgcCA9IE1hdGguZmxvb3IoYWxpY2UucmFuZG9tTnVtYmVyKCkgKiBhbGljZS5nZXRHZW5lcygpLmxlbmd0aCk7XG4gICAgICAgIGNvbnN0IGIxID0gWy4uLmFsaWNlLmdldEdlbmVzKCkuc2xpY2UoMCwgcCksIC4uLmJvYi5nZXRHZW5lcygpLnNsaWNlKHApXTtcbiAgICAgICAgY29uc3QgYjIgPSBbLi4uYm9iLmdldEdlbmVzKCkuc2xpY2UoMCwgcCksIC4uLmFsaWNlLmdldEdlbmVzKCkuc2xpY2UocCldO1xuICAgICAgICByZXR1cm4gW2IxLCBiMl07XG4gICAgfSxcbiAgICB0d29Qb2ludDogKGFsaWNlLCBib2IpID0+IHtcbiAgICAgICAgY29uc3QgYjEgPSBbXTtcbiAgICAgICAgY29uc3QgYjIgPSBbXTtcbiAgICAgICAgY29uc3QgYWxpY2VzR2VuZXMgPSBhbGljZS5nZXRHZW5lcygpO1xuICAgICAgICBjb25zdCBib2JzR2VuZXMgPSBib2IuZ2V0R2VuZXMoKTtcbiAgICAgICAgY29uc3QgYWxpY2VDaHJvbW9MZW5ndGggPSBhbGljZS5nZXRHZW5lcygpLmxlbmd0aDtcbiAgICAgICAgbGV0IHAxID0gTWF0aC5mbG9vcihhbGljZS5yYW5kb21OdW1iZXIoKSAqIGFsaWNlQ2hyb21vTGVuZ3RoKTtcbiAgICAgICAgbGV0IHAyID0gTWF0aC5mbG9vcihhbGljZS5yYW5kb21OdW1iZXIoKSAqIGFsaWNlQ2hyb21vTGVuZ3RoKTtcbiAgICAgICAgaWYgKHAxID4gcDIpIHtcbiAgICAgICAgICAgIFtwMSwgcDJdID0gW3AyLCBwMV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGljZUNocm9tb0xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBiMS5wdXNoKGkgPCBwMSA/IGFsaWNlc0dlbmVzW2ldIDogKGkgPCBwMiA/IGJvYnNHZW5lc1tpXSA6IGFsaWNlc0dlbmVzW2ldKSk7XG4gICAgICAgICAgICBiMi5wdXNoKGkgPCBwMSA/IGJvYnNHZW5lc1tpXSA6IChpIDwgcDIgPyBhbGljZXNHZW5lc1tpXSA6IGJvYnNHZW5lc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbYjEsIGIyXTtcbiAgICB9LFxuICAgIHVuaWZvcm06IChhbGljZSwgYm9iKSA9PiB7XG4gICAgICAgIGNvbnN0IGIxID0gW107XG4gICAgICAgIGNvbnN0IGIyID0gW107XG4gICAgICAgIGNvbnN0IGFsaWNlc0dlbmVzID0gYWxpY2UuZ2V0R2VuZXMoKTtcbiAgICAgICAgY29uc3QgYm9ic0dlbmVzID0gYm9iLmdldEdlbmVzKCk7XG4gICAgICAgIGNvbnN0IGFsaWNlQ2hyb21vTGVuZ3RoID0gYWxpY2UuZ2V0R2VuZXMoKS5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxpY2VDaHJvbW9MZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgc3dhcCA9IGFsaWNlLnJhbmRvbU51bWJlcigpIDwgMC41O1xuICAgICAgICAgICAgYjEucHVzaChzd2FwID8gYm9ic0dlbmVzW2ldIDogYWxpY2VzR2VuZXNbaV0pO1xuICAgICAgICAgICAgYjIucHVzaChzd2FwID8gYWxpY2VzR2VuZXNbaV0gOiBib2JzR2VuZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbYjEsIGIyXTtcbiAgICB9LFxuICAgIGhhbGZVbmlmb3JtOiAoYWxpY2UsIGJvYikgPT4ge1xuICAgICAgICBsZXQgYjEgPSBbXTtcbiAgICAgICAgbGV0IGIyID0gW107XG4gICAgICAgIGNvbnN0IGFsaWNlc0dlbmVzID0gYWxpY2UuZ2V0R2VuZXMoKTtcbiAgICAgICAgY29uc3QgYm9ic0dlbmVzID0gYm9iLmdldEdlbmVzKCk7XG4gICAgICAgIGNvbnN0IGFsaWNlQ2hyb21vTGVuZ3RoID0gYWxpY2UuZ2V0R2VuZXMoKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGRpZmZCaXRzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxpY2VDaHJvbW9MZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGFsaWNlc0dlbmVzW2ldICE9PSBib2JzR2VuZXNbaV0pIHtcbiAgICAgICAgICAgICAgICBkaWZmQml0cy5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IE4gPSBkaWZmQml0cy5sZW5ndGg7XG4gICAgICAgIGIxID0gYWxpY2VzR2VuZXMuc2xpY2UoKTtcbiAgICAgICAgYjIgPSBib2JzR2VuZXMuc2xpY2UoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaWR4ID0gTWF0aC5mbG9vcihhbGljZS5yYW5kb21OdW1iZXIoKSAqIGRpZmZCaXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBiMVtkaWZmQml0c1tpZHhdXSA9IGJvYnNHZW5lc1tkaWZmQml0c1tpZHhdXTtcbiAgICAgICAgICAgIGIyW2RpZmZCaXRzW2lkeF1dID0gYWxpY2VzR2VuZXNbZGlmZkJpdHNbaWR4XV07XG4gICAgICAgICAgICBkaWZmQml0cy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2IxLCBiMl07XG4gICAgfSxcbiAgICBvcmRlcmVkOiAoYWxpY2UsIGJvYikgPT4ge1xuICAgICAgICBjb25zdCBiMSA9IFtdO1xuICAgICAgICBjb25zdCBiMiA9IFtdO1xuICAgICAgICBjb25zdCBhbGljZXNHZW5lcyA9IGFsaWNlLmdldEdlbmVzKCk7XG4gICAgICAgIGNvbnN0IGJvYnNHZW5lcyA9IGJvYi5nZXRHZW5lcygpO1xuICAgICAgICBjb25zdCBhbGljZUNocm9tb0xlbmd0aCA9IGFsaWNlLmdldEdlbmVzKCkubGVuZ3RoO1xuICAgICAgICBsZXQgaW5mID0gTWF0aC5mbG9vcihhbGljZS5yYW5kb21OdW1iZXIoKSAqIGFsaWNlQ2hyb21vTGVuZ3RoKTtcbiAgICAgICAgbGV0IHN1cCA9IE1hdGguZmxvb3IoYWxpY2UucmFuZG9tTnVtYmVyKCkgKiBhbGljZUNocm9tb0xlbmd0aCk7XG4gICAgICAgIGxldCB0bXAgPSBpbmY7XG4gICAgICAgIGluZiA9IE1hdGgubWluKGluZiwgc3VwKTtcbiAgICAgICAgc3VwID0gTWF0aC5tYXgodG1wLCBzdXApO1xuICAgICAgICBmb3IgKGxldCBpID0gaW5mOyBpIDwgc3VwOyBpKyspIHtcbiAgICAgICAgICAgIGIxW2ldID0gYm9ic0dlbmVzW2ldO1xuICAgICAgICAgICAgYjJbaV0gPSBhbGljZXNHZW5lc1tpXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsaWNlQ2hyb21vTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChiMS5pbmRleE9mKGFsaWNlc0dlbmVzW2ldKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBiMVtpXSA9IGFsaWNlc0dlbmVzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhbGljZUNocm9tb0xlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiMS5pbmRleE9mKGFsaWNlc0dlbmVzW2pdKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIxW2ldID0gYWxpY2VzR2VuZXNbal07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYjIuaW5kZXhPZihib2JzR2VuZXNbaV0pID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGIyW2ldID0gYm9ic0dlbmVzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBib2JzR2VuZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIyLmluZGV4T2YoYm9ic0dlbmVzW2pdKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIyW2ldID0gYm9ic0dlbmVzW2pdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbYjEsIGIyXTtcbiAgICB9XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkRhcndpbiA9IHZvaWQgMDtcbmNvbnN0IENocm9tb3NvbWVfMSA9IHJlcXVpcmUoXCIuL0Nocm9tb3NvbWVcIik7XG5jb25zdCBDcm9zc292ZXJNZXRob2RzXzEgPSByZXF1aXJlKFwiLi9Dcm9zc292ZXJNZXRob2RzXCIpO1xuY29uc3QgTXV0YXRpb25NZXRob2RfMSA9IHJlcXVpcmUoXCIuL011dGF0aW9uTWV0aG9kXCIpO1xuY29uc3QgVXRpbHNfMSA9IHJlcXVpcmUoXCIuL1V0aWxzXCIpO1xuY2xhc3MgRGFyd2luIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5wb3B1bGF0aW9uID0gW107XG4gICAgICAgIHRoaXMuc3RhdHNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5nZW5lcmF0aW9uID0gMDtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBPYmplY3QuYXNzaWduKHsgY3Jvc3NvdmVyUmF0ZTogMC43LCBtdXRhdGlvblJhdGU6IDEgLyBwYXJhbXMucG9wdWxhdGlvblNpemUsIGNyb3Nzb3Zlck1ldGhvZDogQ3Jvc3NvdmVyTWV0aG9kc18xLmNyb3Nzb3Zlck1ldGhvZC5zaW5nbGVQb2ludCwgbXV0YXRpb25NZXRob2Q6IE11dGF0aW9uTWV0aG9kXzEubXV0YXRpb25NZXRob2QuZmxpcCwgZWxpdGVDb3VudDogTWF0aC5jZWlsKHBhcmFtcy5wb3B1bGF0aW9uU2l6ZSAvIDI1KSwgZWxpdGVDb3BpZXM6IDEsIHJhbmRvbU51bWJlcjogTWF0aC5yYW5kb20gfSwgcGFyYW1zKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbXMucG9wdWxhdGlvblNpemU7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY2hyb21vID0gQ2hyb21vc29tZV8xLkNocm9tb3NvbWUuZ2VuZXJhdGUodGhpcy5wYXJhbXMuY2hyb21vc29tZUxlbmd0aCwgdGhpcy5wYXJhbXMucmFuZG9tR2VuZSwgdGhpcy5wYXJhbXMucmFuZG9tTnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMucG9wdWxhdGlvbi5wdXNoKGNocm9tbyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgICAgICAgIGZpdHRlc3Q6IHRoaXMucG9wdWxhdGlvblswXSxcbiAgICAgICAgICAgIGF2ZXJhZ2VGaXRuZXNzOiAwLFxuICAgICAgICAgICAgdG90YWxGaXRuZXNzOiAwLFxuICAgICAgICAgICAgZml0dGVzdEluZGV4OiAwXG4gICAgICAgIH07XG4gICAgfVxuICAgIGR1cGxpY2F0ZUVsaXRlKG5ld1BvcHVsYXRpb24pIHtcbiAgICAgICAgLy8gRUxJVElTTSBpLmUuIGtlZXBpbmcgdGhlIGZpdHRlc3QgQ2hyb21vc29tZXNcbiAgICAgICAgY29uc3QgeyBlbGl0ZUNvdW50LCBlbGl0ZUNvcGllcyB9ID0gdGhpcy5wYXJhbXM7XG4gICAgICAgIGlmIChlbGl0ZUNvdW50ID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZWxpdGUgPSB0aGlzLmdldFRvcENocm9tb3NvbWVzKGVsaXRlQ291bnQpO1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgZml0dGVzdCBDaHJvbW9zb21lc1xuICAgICAgICAgICAgbmV3UG9wdWxhdGlvbi5wdXNoKC4uLmVsaXRlKTtcbiAgICAgICAgICAgIC8vIER1cGxpY2F0ZSB0aGUgZWxpdGVcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxpdGVDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBlbGl0ZUNvcGllczsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1BvcHVsYXRpb24ucHVzaChlbGl0ZVtpXS5jbG9uZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3Jvc3NvdmVyKG5ld1BvcHVsYXRpb24pIHtcbiAgICAgICAgY29uc3QgeyBwb3B1bGF0aW9uU2l6ZSwgY3Jvc3NvdmVyUmF0ZSwgY3Jvc3NvdmVyTWV0aG9kLCByYW5kb21HZW5lLCByYW5kb21OdW1iZXIgfSA9IHRoaXMucGFyYW1zO1xuICAgICAgICB3aGlsZSAobmV3UG9wdWxhdGlvbi5sZW5ndGggPCBwb3B1bGF0aW9uU2l6ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyYW1zLnJhbmRvbU51bWJlcigpIDwgY3Jvc3NvdmVyUmF0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG11bSA9IHRoaXMuZ2V0UmFuZG9tQ2hyb21vc29tZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhZCA9IHRoaXMuZ2V0UmFuZG9tQ2hyb21vc29tZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IFtiYWJ5MSwgYmFieTJdID0gbXVtLmNyb3Nzb3ZlcldpdGgoZGFkLCBjcm9zc292ZXJNZXRob2QpO1xuICAgICAgICAgICAgICAgIG5ld1BvcHVsYXRpb24ucHVzaChuZXcgQ2hyb21vc29tZV8xLkNocm9tb3NvbWUoYmFieTEsIHJhbmRvbUdlbmUsIHJhbmRvbU51bWJlciksIG5ldyBDaHJvbW9zb21lXzEuQ2hyb21vc29tZShiYWJ5MiwgcmFuZG9tR2VuZSwgcmFuZG9tTnVtYmVyKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gQmVjYXVzZSB3ZSBhZGQgdHdvIGNocm9tb3NvbWVzIHBlciBsb29wXG4gICAgICAgIC8vIGlmIHBvcHVsYXRpb25fc2l6ZSBpcyBvZGRcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnBvcHVsYXRpb25TaXplICUgMiA9PT0gMSkge1xuICAgICAgICAgICAgbmV3UG9wdWxhdGlvbi5wb3AoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtdXRhdGUobmV3UG9wdWxhdGlvbikge1xuICAgICAgICBmb3IgKGNvbnN0IGMgb2YgbmV3UG9wdWxhdGlvbikge1xuICAgICAgICAgICAgYy5tdXRhdGVXaXRoKHRoaXMucGFyYW1zLm11dGF0aW9uUmF0ZSwgdGhpcy5wYXJhbXMubXV0YXRpb25NZXRob2QpO1xuICAgICAgICAgICAgLy8gYy5zZXRGaXRuZXNzKDApOyAvLyByZXNldCBmaXRuZXNzXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgZml0bmVzcyBvZiB0aGUgZW50aXJlIHBvcHVsYXRpb25cbiAgICAgKiBieSBldmFsdWF0aW5nIHRoZSBmaXRuZXNzIG9mIGVhY2ggY2hyb21vc29tZVxuICAgICAqIHVzaW5nIHRoZSBnaXZlbiBmdW5jdGlvblxuICAgICAqL1xuICAgIHVwZGF0ZUZpdG5lc3MoZml0bmVzc0V2YWx1YXRvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucG9wdWxhdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY2hyb21vID0gdGhpcy5wb3B1bGF0aW9uW2ldO1xuICAgICAgICAgICAgY2hyb21vLnNldEZpdG5lc3MoZml0bmVzc0V2YWx1YXRvcihjaHJvbW8uZ2V0R2VuZXMoKSwgaSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGdlbmVyYXRlcyBhIG5ldyBnZW5lcmF0aW9uXG4gICAgICogdGhlIGZpdG5lc3Mgb2YgZWFjaCBjaHJvbW9zb21lIG11c3QgYmUgdXBkYXRlZCBiZWZvcmUgY2FsbGluZyB0aGlzIGZ1bmN0aW9uXG4gICAgICogdXNpbmcgYHNldEZpdG5lc3NgIG9uIGVhY2ggY2hyb21vc29tZSBvciBgdXBkYXRlRml0bmVzc2BcbiAgICAgKi9cbiAgICBtYXRlKCkge1xuICAgICAgICBjb25zdCBuZXdQb3B1bGF0aW9uID0gW107XG4gICAgICAgIC8vIEVMSVRJU01cbiAgICAgICAgdGhpcy5kdXBsaWNhdGVFbGl0ZShuZXdQb3B1bGF0aW9uKTtcbiAgICAgICAgLy8gUkVQUk9EVUNUSU9OXG4gICAgICAgIHRoaXMuY3Jvc3NvdmVyKG5ld1BvcHVsYXRpb24pO1xuICAgICAgICB0aGlzLm11dGF0ZShuZXdQb3B1bGF0aW9uKTtcbiAgICAgICAgLy8gdXB0YXRlIHRoZSBwb3B1bGF0aW9uXG4gICAgICAgIHRoaXMucG9wdWxhdGlvbiA9IG5ld1BvcHVsYXRpb247XG4gICAgICAgIHRoaXMuZ2VuZXJhdGlvbiArPSAxO1xuICAgICAgICB0aGlzLnN0YXRzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHRoZSBlbnRpcmUgcG9wdWxhdGlvblxuICAgICAqL1xuICAgIGdldFBvcHVsYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvcHVsYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHRoZSBjaHJvbW9zb21lIGF0IGluZGV4IGBpbmRleGBcbiAgICAgKi9cbiAgICBnZXRDaHJvbW9zb21lQXQoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGlvbltpbmRleF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIGEgcmFuZG9tIGNocm9tb3NvbWUgZnJvbSB0aGUgcG9wdWxhdGlvblxuICAgICAqIHdoZXJlIHRoZSBwcm9iYWJpbGl0eSBvZiBiZWluZyBzZWxlY3RlZCBpcyBwcm9wb3J0aW9uYWwgdG8gdGhlIGZpdG5lc3NcbiAgICAgKi9cbiAgICBnZXRSYW5kb21DaHJvbW9zb21lKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXRzKCk7XG4gICAgICAgIGlmICh0aGlzLnN0YXRzLnRvdGFsRml0bmVzcyA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGlvbltNYXRoLmZsb29yKHRoaXMucGFyYW1zLnJhbmRvbU51bWJlcigpICogdGhpcy5wb3B1bGF0aW9uLmxlbmd0aCldO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLnBhcmFtcy5yYW5kb21OdW1iZXIoKSAqIHRoaXMuc3RhdHMudG90YWxGaXRuZXNzO1xuICAgICAgICBsZXQgYWNjdW11bGF0ZWRGaXRuZXNzID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBvcHVsYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFjY3VtdWxhdGVkRml0bmVzcyArPSB0aGlzLnBvcHVsYXRpb25baV0uZ2V0Rml0bmVzcygpO1xuICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGVkRml0bmVzcyA+IHIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wb3B1bGF0aW9uW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlblxuICAgICAgICByZXR1cm4gdGhpcy5wb3B1bGF0aW9uWzBdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBlZmZpY2llbnRseSBjb21wdXRlcyB0aGUgYGNvdW50YCBiZXN0IGNocm9tb3NvbWVzXG4gICAgICogaW4gdGhlIHBvcHVsYXRpb24gYmFzZWQgb24gdGhlaXIgZml0bmVzc1xuICAgICAqL1xuICAgIGdldFRvcENocm9tb3NvbWVzKGNvdW50KSB7XG4gICAgICAgIHJldHVybiBVdGlsc18xLnNlbGVjdEtCZXN0KHRoaXMucG9wdWxhdGlvbiwgY291bnQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB0aGUgcGFyYW1ldGVycyB1c2VkIHRvIGNvbnN0cnVjdCB0aGlzIERhcndpbiBpbnN0YW5jZVxuICAgICAqL1xuICAgIGdldFBhcmFtcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB0aGUgY3VycmVudCBnZW5lcmF0aW9uXG4gICAgICovXG4gICAgZ2V0R2VuZXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgbGF0ZXN0IHN0YXRpc3RpY3MsXG4gICAgICogdG8gY29tcHV0ZSBhbiB1cGRhdGVkIHZlcnNpb24gY2FsbCBgdXBkYXRlU3RhdHNgXG4gICAgICovXG4gICAgZ2V0U3RhdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiB1cGRhdGUgdGhlIHN0YXRpc3RpY3MgZm9yIHRoaXMgZ2VuZXJhdGlvblxuICAgICAqIGlmIGBmb3JjZVVwZGF0ZWAgaXMgdHJ1ZSwgdXBkYXRlIGV2ZW4gaWYgYG1hdGVgXG4gICAgICogaGFzIG5vdCBiZWVuIGNhbGxlZFxuICAgICAqL1xuICAgIHVwZGF0ZVN0YXRzKGZvcmNlVXBkYXRlID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGZvcmNlVXBkYXRlIHx8IHRoaXMuc3RhdHNOZWVkVXBkYXRlKSB7XG4gICAgICAgICAgICBsZXQgdG90YWxGaXRuZXNzID0gMDtcbiAgICAgICAgICAgIGxldCBtYXhGaXRuZXNzID0gMDtcbiAgICAgICAgICAgIGxldCBmaXR0ZXN0SW5kZXggPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBvcHVsYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaXRuZXNzID0gdGhpcy5wb3B1bGF0aW9uW2ldLmdldEZpdG5lc3MoKTtcbiAgICAgICAgICAgICAgICB0b3RhbEZpdG5lc3MgKz0gZml0bmVzcztcbiAgICAgICAgICAgICAgICBpZiAoZml0bmVzcyA+IG1heEZpdG5lc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Rml0bmVzcyA9IGZpdG5lc3M7XG4gICAgICAgICAgICAgICAgICAgIGZpdHRlc3RJbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdGF0cy50b3RhbEZpdG5lc3MgPSB0b3RhbEZpdG5lc3M7XG4gICAgICAgICAgICB0aGlzLnN0YXRzLmF2ZXJhZ2VGaXRuZXNzID0gdG90YWxGaXRuZXNzIC8gdGhpcy5wYXJhbXMucG9wdWxhdGlvblNpemU7XG4gICAgICAgICAgICB0aGlzLnN0YXRzLmZpdHRlc3QgPSB0aGlzLnBvcHVsYXRpb25bZml0dGVzdEluZGV4XS5jbG9uZSgpO1xuICAgICAgICAgICAgdGhpcy5zdGF0cy5maXR0ZXN0SW5kZXggPSBmaXR0ZXN0SW5kZXg7XG4gICAgICAgICAgICB0aGlzLnN0YXRzTmVlZFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRzO1xuICAgIH1cbn1cbmV4cG9ydHMuRGFyd2luID0gRGFyd2luO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkRlYmx1cnJlciA9IGV4cG9ydHMucmVuZGVyQmx1cnJlZFRleHQgPSB2b2lkIDA7XG5jb25zdCBDcm9zc292ZXJNZXRob2RzXzEgPSByZXF1aXJlKFwiLi4vLi4vQ3Jvc3NvdmVyTWV0aG9kc1wiKTtcbmNvbnN0IERhcndpbl8xID0gcmVxdWlyZShcIi4uLy4uL0RhcndpblwiKTtcbmNvbnN0IE11dGF0aW9uTWV0aG9kXzEgPSByZXF1aXJlKFwiLi4vLi4vTXV0YXRpb25NZXRob2RcIik7XG5jb25zdCBUZXh0XzEgPSByZXF1aXJlKFwiLi4vY29tbW9uL1RleHRcIik7XG5jb25zdCBVdGlsc18xID0gcmVxdWlyZShcIi4uL2NvbW1vbi9VdGlsc1wiKTtcbmNvbnN0IG1heFBvc3NpYmxlRml0bmVzcyA9IDEwMDA7XG5jb25zdCBldmFsRml0bmVzcyA9IChzb3VyY2UsIHRhcmdldCkgPT4ge1xuICAgIGxldCBkaWZmU3VtID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5kYXRhLmxlbmd0aDsgaSArPSA0KSB7XG4gICAgICAgIGNvbnN0IGRpZmYgPSBNYXRoLmFicyh0YXJnZXQuZGF0YVtpICsgM10gLSBzb3VyY2UuZGF0YVtpICsgM10pO1xuICAgICAgICBkaWZmU3VtICs9IE1hdGgucG93KCgyNTUgLSBkaWZmKSwgMik7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLnBvdygxMDAwLCAoZGlmZlN1bSAvIChNYXRoLnBvdygyNTUsIDIpICogc291cmNlLmRhdGEubGVuZ3RoIC8gNCkpKTtcbn07XG5jb25zdCByZW5kZXJCbHVycmVkVGV4dCA9IChjdHgsIHRleHQsIGZvbnQsIGJsdXJSYWRpdXMpID0+IHtcbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcbiAgICBjdHguZm9udCA9IGZvbnQ7XG4gICAgY3R4LmZpbHRlciA9IGBibHVyKCR7Ymx1clJhZGl1c31weClgO1xuICAgIGN0eC5maWxsVGV4dCh0ZXh0LCAyLCAzMCk7XG59O1xuZXhwb3J0cy5yZW5kZXJCbHVycmVkVGV4dCA9IHJlbmRlckJsdXJyZWRUZXh0O1xuY29uc3QgbWVhc3VyZVRleHQgPSAodGV4dCwgZm9udCkgPT4ge1xuICAgIGNvbnN0IFtfLCBjdHhdID0gVXRpbHNfMS5jcmVhdGVDYW52YXMoeyB3aWR0aDogMTAwMCwgaGVpZ2h0OiAxMDAgfSk7XG4gICAgY3R4LmZvbnQgPSBmb250O1xuICAgIHJldHVybiBjdHgubWVhc3VyZVRleHQodGV4dCk7XG59O1xuY2xhc3MgRGVibHVycmVyIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5iZXN0Rml0bmVzcyA9IDA7XG4gICAgICAgIHRoaXMuYmVzdFRleHQgPSAnJztcbiAgICAgICAgdGhpcy5tZW1vID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnVwZGF0ZSA9IChwYXJhbXMpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgICAgICAgICAgdGhpcy50YXJnZXRJbWFnZURhdGEgPSB0aGlzLnJlbmRlclRhcmdldCgpO1xuICAgICAgICAgICAgdGhpcy5wb3B1bGF0aW9uID0gbmV3IERhcndpbl8xLkRhcndpbih0aGlzLnVwZGF0ZURhcndpblBhcmFtcygpKTtcbiAgICAgICAgICAgIHRoaXMuYmVzdEZpdG5lc3MgPSAwO1xuICAgICAgICAgICAgdGhpcy5iZXN0VGV4dCA9ICcnO1xuICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUNvbnRleHRzKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudGFyZ2V0Q29udGV4dCA9IFV0aWxzXzEuY3JlYXRlQ2FudmFzKHt9LCB7XG4gICAgICAgICAgICBib3JkZXI6ICcxcHggc29saWQgYmxhY2snXG4gICAgICAgIH0pWzFdO1xuICAgICAgICB0aGlzLnVwZGF0ZShwYXJhbXMpO1xuICAgIH1cbiAgICB1cGRhdGUocGFyYW1zKSB7XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgICAgICB0aGlzLnJlbmRlclRhcmdldCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZURhcndpblBhcmFtcygpO1xuICAgICAgICB0aGlzLmdlbmVyYXRlQ29udGV4dHMoKTtcbiAgICAgICAgdGhpcy5wb3B1bGF0aW9uID0gbmV3IERhcndpbl8xLkRhcndpbih0aGlzLmRhcndpblBhcmFtcyk7XG4gICAgICAgIHRoaXMudGFyZ2V0SW1hZ2VEYXRhID0gdGhpcy5yZW5kZXJUYXJnZXQoKTtcbiAgICB9XG4gICAgdXBkYXRlRGFyd2luUGFyYW1zKCkge1xuICAgICAgICB0aGlzLmRhcndpblBhcmFtcyA9IHtcbiAgICAgICAgICAgIHBvcHVsYXRpb25TaXplOiB0aGlzLnBhcmFtcy5wb3B1bGF0aW9uU2l6ZSxcbiAgICAgICAgICAgIHJhbmRvbUdlbmU6IFRleHRfMS5yYW5kQ2hhcixcbiAgICAgICAgICAgIGNocm9tb3NvbWVMZW5ndGg6IHRoaXMucGFyYW1zLnRhcmdldC5sZW5ndGgsXG4gICAgICAgICAgICBtdXRhdGlvbk1ldGhvZDogTXV0YXRpb25NZXRob2RfMS5tdXRhdGlvbk1ldGhvZC5mbGlwLFxuICAgICAgICAgICAgY3Jvc3NvdmVyTWV0aG9kOiBDcm9zc292ZXJNZXRob2RzXzEuY3Jvc3NvdmVyTWV0aG9kLnR3b1BvaW50LFxuICAgICAgICAgICAgbXV0YXRpb25SYXRlOiAwLjEsXG4gICAgICAgICAgICBjcm9zc292ZXJSYXRlOiAwLjlcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGFyd2luUGFyYW1zO1xuICAgIH1cbiAgICByZW5kZXJUYXJnZXQoKSB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGggfSA9IG1lYXN1cmVUZXh0KHRoaXMucGFyYW1zLnRhcmdldCwgdGhpcy5wYXJhbXMuZm9udCk7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aCArIDU7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gMzU7XG4gICAgICAgIHRoaXMudGFyZ2V0Q29udGV4dC5jYW52YXMud2lkdGggPSB0aGlzLndpZHRoO1xuICAgICAgICB0aGlzLnRhcmdldENvbnRleHQuY2FudmFzLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xuICAgICAgICBleHBvcnRzLnJlbmRlckJsdXJyZWRUZXh0KHRoaXMudGFyZ2V0Q29udGV4dCwgdGhpcy5wYXJhbXMudGFyZ2V0LCB0aGlzLnBhcmFtcy5mb250LCB0aGlzLnBhcmFtcy5ibHVyUmFkaXVzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0Q29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIH1cbiAgICBnZW5lcmF0ZUNvbnRleHRzKCkge1xuICAgICAgICB0aGlzLmNvbnRleHRzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wYXJhbXMucG9wdWxhdGlvblNpemU7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0cy5wdXNoKFV0aWxzXzEuY3JlYXRlQ2FudmFzKHtcbiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAnMXB4IHNvbGlkIGJsYWNrJ1xuICAgICAgICAgICAgfSlbMV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIDtcbiAgICB0aWNrKCkge1xuICAgICAgICBpZiAodGhpcy5tZW1vLnNpemUgPiAxMDAwMCkge1xuICAgICAgICAgICAgdGhpcy5tZW1vLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3B1bGF0aW9uLnVwZGF0ZUZpdG5lc3MoKGNoYXJzLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgY29uc3QgY3R4ID0gdGhpcy5jb250ZXh0c1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2hhcnMuam9pbignJyk7XG4gICAgICAgICAgICBleHBvcnRzLnJlbmRlckJsdXJyZWRUZXh0KGN0eCwgdGV4dCwgdGhpcy5wYXJhbXMuZm9udCwgdGhpcy5wYXJhbXMuYmx1clJhZGl1cyk7XG4gICAgICAgICAgICBpZiAoIXRoaXMubWVtby5oYXModGV4dCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaXRuZXNzID0gZXZhbEZpdG5lc3MoY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCksIHRoaXMudGFyZ2V0SW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAoZml0bmVzcyA+IHRoaXMuYmVzdEZpdG5lc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXN0Rml0bmVzcyA9IGZpdG5lc3M7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmVzdFRleHQgPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmJlc3RUZXh0LCB0aGlzLmJlc3RGaXRuZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5tZW1vLnNldCh0ZXh0LCBmaXRuZXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAoX2EgPSB0aGlzLm1lbW8uZ2V0KHRleHQpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLm9uVGljaykge1xuICAgICAgICAgICAgdGhpcy5wYXJhbXMub25UaWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3B1bGF0aW9uLm1hdGUoKTtcbiAgICB9XG4gICAgO1xuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGljaygpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nICYmIHRoaXMuYmVzdEZpdG5lc3MgPCBtYXhQb3NzaWJsZUZpdG5lc3MpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB1cGRhdGUoKTtcbiAgICB9XG4gICAgO1xuICAgIGdldEN1cnJlbnRCZXN0KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLmJlc3RUZXh0LFxuICAgICAgICAgICAgZml0bmVzczogdGhpcy5iZXN0Rml0bmVzc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXRUYXJnZXRDb250ZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRDb250ZXh0O1xuICAgIH1cbiAgICBnZXRQb3B1bGF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3B1bGF0aW9uO1xuICAgIH1cbiAgICBnZXRDb250ZXh0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dHM7XG4gICAgfVxufVxuZXhwb3J0cy5EZWJsdXJyZXIgPSBEZWJsdXJyZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMucmFuZENoYXIgPSBleHBvcnRzLmFscGhhYmV0ID0gdm9pZCAwO1xuZXhwb3J0cy5hbHBoYWJldCA9IFtcbiAgICAnYScsICdiJywgJ2MnLCAnZCcsICdlJywgJ2YnLCAnZycsICdoJywgJ2knLCAnaicsICdrJyxcbiAgICAnbCcsICdtJywgJ24nLCAnbycsICdwJywgJ3EnLCAncicsICdzJywgJ3QnLCAndScsICd2JywgJ3cnLCAneCcsICd5JywgJ3onLCAnICcsXG4gICAgJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onLCAnSycsICdMJywgJ00nLCAnTicsICdPJywgJ1AnLCAnUScsICdSJywgJ1MnLCAnVCcsXG4gICAgJ1UnLCAnVicsICdXJywgJ1gnLCAnWScsICdaJywgJz8nLCAnIScsICcuJywgJyMnLCAnQCcsICcmJywgJyonLCAnJCcsICclJywgJysnLCAnLScsICcvJywgJz0nLFxuICAgICcwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJygnLCAnKScsICcsJywgXCInXCIsICdcIicsICc6JywgJ18nLCAnLSdcbl07XG5mdW5jdGlvbiByYW5kQ2hhcigpIHtcbiAgICByZXR1cm4gZXhwb3J0cy5hbHBoYWJldFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBleHBvcnRzLmFscGhhYmV0Lmxlbmd0aCldO1xufVxuZXhwb3J0cy5yYW5kQ2hhciA9IHJhbmRDaGFyO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm5hbWVkSW5wdXQgPSBleHBvcnRzLmFwcGVuZENoaWxkcmVuID0gZXhwb3J0cy5jcmVhdGVDYW52YXMgPSBleHBvcnRzLmggPSB2b2lkIDA7XG5jb25zdCBoID0gKG5hbWUsIHByb3BzID0ge30sIHN0eWxlID0ge30pID0+IHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTtcbiAgICBmb3IgKGNvbnN0IFtwcm9wLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocHJvcHMpKSB7XG4gICAgICAgIGVsZW1lbnRbcHJvcF0gPSB2YWx1ZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBydWxlIGluIHN0eWxlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gc3R5bGVbcnVsZV07XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlW3J1bGVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59O1xuZXhwb3J0cy5oID0gaDtcbmNvbnN0IGNyZWF0ZUNhbnZhcyA9IChwcm9wcyA9IHt9LCBzdHlsZSA9IHt9KSA9PiB7XG4gICAgY29uc3QgY252ID0gZXhwb3J0cy5oKCdjYW52YXMnLCBwcm9wcywgc3R5bGUpO1xuICAgIGNvbnN0IGN0eCA9IGNudi5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGlmIChjdHggPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgY3JlYXRlIGEgMmQgY2FudmFzYCk7XG4gICAgfVxuICAgIHJldHVybiBbY252LCBjdHhdO1xufTtcbmV4cG9ydHMuY3JlYXRlQ2FudmFzID0gY3JlYXRlQ2FudmFzO1xuY29uc3QgYXBwZW5kQ2hpbGRyZW4gPSAodGFyZ2V0LCBjaGlscmVuKSA9PiB7XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiBjaGlscmVuKSB7XG4gICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59O1xuZXhwb3J0cy5hcHBlbmRDaGlsZHJlbiA9IGFwcGVuZENoaWxkcmVuO1xuY29uc3QgbmFtZWRJbnB1dCA9IChuYW1lLCBwcm9wcykgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZXhwb3J0cy5oKCdpbnB1dCcsIHByb3BzKTtcbiAgICBjb25zdCBzcGFuID0gZXhwb3J0cy5oKCdzcGFuJywgeyB0ZXh0Q29udGVudDogcHJvcHMudHlwZSA9PT0gJ3JhbmdlJyA/IGAke25hbWV9IDogJHtpbnB1dC52YWx1ZX1gIDogbmFtZSB9KTtcbiAgICBjb25zdCBkaXYgPSBleHBvcnRzLmFwcGVuZENoaWxkcmVuKGV4cG9ydHMuaCgnZGl2JyksIFtzcGFuLCBpbnB1dF0pO1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgaWYgKHByb3BzLnR5cGUgPT09ICdyYW5nZScpIHtcbiAgICAgICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBgJHtuYW1lfSA6ICR7aW5wdXQudmFsdWV9YDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGVsZW06IGRpdixcbiAgICAgICAgdmFsdWU6ICgpID0+IGlucHV0LnZhbHVlXG4gICAgfTtcbn07XG5leHBvcnRzLm5hbWVkSW5wdXQgPSBuYW1lZElucHV0O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm11dGF0aW9uTWV0aG9kID0gdm9pZCAwO1xuZXhwb3J0cy5tdXRhdGlvbk1ldGhvZCA9IHtcbiAgICBmbGlwOiAoY2hyb21vc29tZSwgbXV0YXRpb25SYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IGdlbmVzID0gY2hyb21vc29tZS5nZXRHZW5lcygpO1xuICAgICAgICBjb25zdCBsZW5ndGggPSBnZW5lcy5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjaHJvbW9zb21lLnJhbmRvbU51bWJlcigpIDwgbXV0YXRpb25SYXRlKSB7XG4gICAgICAgICAgICAgICAgZ2VuZXNbaV0gPSBjaHJvbW9zb21lLnJhbmRvbUdlbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgc3dhcDogKGNocm9tb3NvbWUsIG11dGF0aW9uUmF0ZSkgPT4ge1xuICAgICAgICBjb25zdCBnZW5lcyA9IGNocm9tb3NvbWUuZ2V0R2VuZXMoKTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gZ2VuZXMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY2hyb21vc29tZS5yYW5kb21OdW1iZXIoKSA8IG11dGF0aW9uUmF0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsZW5ndGgpO1xuICAgICAgICAgICAgICAgIFtnZW5lc1tpXSwgZ2VuZXNbal1dID0gW2dlbmVzW2pdLCBnZW5lc1tpXV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnNlbGVjdEtCZXN0ID0gdm9pZCAwO1xuZnVuY3Rpb24gc2VsZWN0S0Jlc3QoYXJyYXksIGspIHtcbiAgICByZXZlcnNlUGFydGlhbFF1aWNrc29ydChhcnJheSwgayk7XG4gICAgcmV0dXJuIGFycmF5LnNsaWNlKDAsIGspO1xufVxuZXhwb3J0cy5zZWxlY3RLQmVzdCA9IHNlbGVjdEtCZXN0O1xuZnVuY3Rpb24gcXVpY2tzb3J0KGFyciwgZnJvbSA9IDAsIHRvID0gYXJyLmxlbmd0aCAtIDEpIHtcbiAgICBjb25zdCBwaXZvdCA9IGFycltNYXRoLmZsb29yKChmcm9tICsgdG8pIC8gMildLmdldEZpdG5lc3MoKTtcbiAgICBpZiAoZnJvbSA8IHRvKSB7XG4gICAgICAgIGNvbnN0IHAgPSBwYXJ0aXRpb24oYXJyLCBmcm9tLCB0bywgcGl2b3QpO1xuICAgICAgICBxdWlja3NvcnQoYXJyLCBmcm9tLCBwIC0gMSk7XG4gICAgICAgIHF1aWNrc29ydChhcnIsIHAsIHRvKTtcbiAgICB9XG59XG5mdW5jdGlvbiByZXZlcnNlUGFydGlhbFF1aWNrc29ydChhcnIsIGssIGZyb20gPSAwLCB0byA9IGFyci5sZW5ndGggLSAxKSB7XG4gICAgY29uc3QgcGl2b3QgPSBhcnJbTWF0aC5mbG9vcigoZnJvbSArIHRvKSAvIDIpXS5nZXRGaXRuZXNzKCk7XG4gICAgaWYgKGZyb20gPCB0bykge1xuICAgICAgICBjb25zdCBwID0gcGFydGl0aW9uKGFyciwgZnJvbSwgdG8sIHBpdm90KTtcbiAgICAgICAgcXVpY2tzb3J0KGFyciwgZnJvbSwgcCAtIDEpO1xuICAgICAgICBpZiAocCA8IGspIHtcbiAgICAgICAgICAgIHF1aWNrc29ydChhcnIsIHAsIHRvKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnRpdGlvbihhcnJheSwgbGVmdCwgcmlnaHQsIHBpdm90KSB7XG4gICAgLy8gcHV0IGV2ZXJ5IGVsZW1lbnQgc21hbGxlciB0aGFuIHRoZSBwaXZvdCB0byBpdHMgbGVmdFxuICAgIC8vIGFuZCBldmVyeSBlbGVtZW50IGJpZ2dlciB0byBpdHMgcmlnaHRcbiAgICAvLyByZXR1cm5pbmcgdGhlIHBpdm90J3MgcG9zaXRpb25cbiAgICB3aGlsZSAobGVmdCA8PSByaWdodCkge1xuICAgICAgICB3aGlsZSAoYXJyYXlbbGVmdF0uZ2V0Rml0bmVzcygpID4gcGl2b3QpIHtcbiAgICAgICAgICAgIGxlZnQrKztcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoYXJyYXlbcmlnaHRdLmdldEZpdG5lc3MoKSA8IHBpdm90KSB7XG4gICAgICAgICAgICByaWdodC0tO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZWZ0IDw9IHJpZ2h0KSB7XG4gICAgICAgICAgICBbYXJyYXlbbGVmdF0sIGFycmF5W3JpZ2h0XV0gPSBbYXJyYXlbcmlnaHRdLCBhcnJheVtsZWZ0XV07XG4gICAgICAgICAgICBsZWZ0Kys7XG4gICAgICAgICAgICByaWdodC0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsZWZ0O1xufVxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgVXRpbHNfMSA9IHJlcXVpcmUoXCIuLi9jb21tb24vVXRpbHNcIik7XG5jb25zdCBEZWJsdXJfMSA9IHJlcXVpcmUoXCIuL0RlYmx1clwiKTtcbmNvbnN0IHNldHVwID0gKCkgPT4ge1xuICAgIGNvbnN0IHRleHQgPSBVdGlsc18xLm5hbWVkSW5wdXQoJ3RleHQnLCB7XG4gICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgdmFsdWU6ICdEQVJXSU4nLFxuICAgICAgICBvbmNoYW5nZTogb25VcGRhdGUsXG4gICAgICAgIG9ua2V5dXA6IG9uVXBkYXRlXG4gICAgfSk7XG4gICAgY29uc3QgYmx1clJhZGl1cyA9IFV0aWxzXzEubmFtZWRJbnB1dCgnYmx1ciByYWRpdXMnLCB7XG4gICAgICAgIHR5cGU6ICdyYW5nZScsXG4gICAgICAgIG1pbjogJzAnLFxuICAgICAgICBtYXg6ICcxMCcsXG4gICAgICAgIHN0ZXA6ICcxJyxcbiAgICAgICAgdmFsdWU6ICc0JyxcbiAgICAgICAgb25jaGFuZ2U6IG9uVXBkYXRlXG4gICAgfSk7XG4gICAgY29uc3QgZm9udFNpemUgPSBVdGlsc18xLm5hbWVkSW5wdXQoJ2ZvbnQgc2l6ZScsIHtcbiAgICAgICAgdHlwZTogJ3JhbmdlJyxcbiAgICAgICAgbWluOiAnMTAnLFxuICAgICAgICBtYXg6ICc0MCcsXG4gICAgICAgIHN0ZXA6ICcxJyxcbiAgICAgICAgdmFsdWU6ICczMCcsXG4gICAgICAgIG9uY2hhbmdlOiBvblVwZGF0ZVxuICAgIH0pO1xuICAgIGNvbnN0IHBvcHVsYXRpb25TaXplID0gVXRpbHNfMS5uYW1lZElucHV0KCdwb3B1bGF0aW9uJywge1xuICAgICAgICB0eXBlOiAncmFuZ2UnLFxuICAgICAgICBtaW46ICc1JyxcbiAgICAgICAgbWF4OiAnMTAwMCcsXG4gICAgICAgIHN0ZXA6ICcxJyxcbiAgICAgICAgdmFsdWU6ICcyMDAnLFxuICAgICAgICBvbmNoYW5nZTogb25VcGRhdGVcbiAgICB9KTtcbiAgICBjb25zdCBnZW5lcmF0aW9uID0gVXRpbHNfMS5oKCdwJywge1xuICAgICAgICB0ZXh0Q29udGVudDogJ2dlbmVyYXRpb246IDAnXG4gICAgfSk7XG4gICAgY29uc3QgYmVzdCA9IFV0aWxzXzEuaCgncCcsIHtcbiAgICAgICAgdGV4dENvbnRlbnQ6ICdiZXN0OiAnLFxuICAgIH0sIHtcbiAgICAgICAgZm9udFNpemU6ICcyNHB4J1xuICAgIH0pO1xuICAgIGNvbnN0IG9uVGljayA9ICgpID0+IHtcbiAgICAgICAgZ2VuZXJhdGlvbi50ZXh0Q29udGVudCA9IGBnZW5lcmF0aW9uOiAke2RlYmx1cnJlci5nZXRQb3B1bGF0aW9uKCkuZ2V0R2VuZXJhdGlvbigpfWA7XG4gICAgICAgIGJlc3QudGV4dENvbnRlbnQgPSBgYmVzdDogJHtkZWJsdXJyZXIuZ2V0Q3VycmVudEJlc3QoKS5zdHJpbmd9YDtcbiAgICB9O1xuICAgIGNvbnN0IGRlYmx1cnJlciA9IG5ldyBEZWJsdXJfMS5EZWJsdXJyZXIoe1xuICAgICAgICBwb3B1bGF0aW9uU2l6ZTogcGFyc2VJbnQocG9wdWxhdGlvblNpemUudmFsdWUoKSksXG4gICAgICAgIHRhcmdldDogdGV4dC52YWx1ZSgpLFxuICAgICAgICBibHVyUmFkaXVzOiBwYXJzZUludChibHVyUmFkaXVzLnZhbHVlKCkpLFxuICAgICAgICBmb250OiBgJHtmb250U2l6ZS52YWx1ZSgpfXB4IHNhbnMtc2VyaWZgLFxuICAgICAgICBvblRpY2tcbiAgICB9KTtcbiAgICBmdW5jdGlvbiBvblVwZGF0ZSgpIHtcbiAgICAgICAgZGVibHVycmVyLnVwZGF0ZSh7XG4gICAgICAgICAgICBwb3B1bGF0aW9uU2l6ZTogcGFyc2VJbnQocG9wdWxhdGlvblNpemUudmFsdWUoKSksXG4gICAgICAgICAgICB0YXJnZXQ6IHRleHQudmFsdWUoKSxcbiAgICAgICAgICAgIGJsdXJSYWRpdXM6IHBhcnNlSW50KGJsdXJSYWRpdXMudmFsdWUoKSksXG4gICAgICAgICAgICBmb250OiBgJHtmb250U2l6ZS52YWx1ZSgpfXB4IHNhbnMtc2VyaWZgLFxuICAgICAgICAgICAgb25UaWNrXG4gICAgICAgIH0pO1xuICAgICAgICBkZWJsdXJyZXIudGljaygpO1xuICAgICAgICByZXJlbmRlcigpO1xuICAgIH1cbiAgICBjb25zdCBjb250ZXh0cyA9IFV0aWxzXzEuYXBwZW5kQ2hpbGRyZW4oVXRpbHNfMS5oKCdkaXYnLCB7fSwge1xuICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgIGZsZXhXcmFwOiAnd3JhcCdcbiAgICB9KSwgZGVibHVycmVyLmdldENvbnRleHRzKCkubWFwKGN0eCA9PiBjdHguY2FudmFzKSk7XG4gICAgY29uc3QgZG9tRWxlbSA9IFV0aWxzXzEuYXBwZW5kQ2hpbGRyZW4oVXRpbHNfMS5oKCdkaXYnKSwgW1xuICAgICAgICBkZWJsdXJyZXIuZ2V0VGFyZ2V0Q29udGV4dCgpLmNhbnZhcyxcbiAgICAgICAgdGV4dC5lbGVtLFxuICAgICAgICBibHVyUmFkaXVzLmVsZW0sXG4gICAgICAgIGZvbnRTaXplLmVsZW0sXG4gICAgICAgIHBvcHVsYXRpb25TaXplLmVsZW0sXG4gICAgICAgIGdlbmVyYXRpb24sXG4gICAgICAgIGJlc3QsXG4gICAgICAgIFV0aWxzXzEuaCgnYnV0dG9uJywge1xuICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICdzdGFydCcsXG4gICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gZGVibHVycmVyLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgZGVibHVycmVyLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBjb250ZXh0c1xuICAgIF0pO1xuICAgIGNvbnN0IHJlcmVuZGVyID0gKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygncmVyZW5kZXInLCBkZWJsdXJyZXIuZ2V0Q29udGV4dHMoKS5sZW5ndGgpO1xuICAgICAgICBjb250ZXh0cy5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgVXRpbHNfMS5hcHBlbmRDaGlsZHJlbihjb250ZXh0cywgZGVibHVycmVyLmdldENvbnRleHRzKCkubWFwKGN0eCA9PiBjdHguY2FudmFzKSk7XG4gICAgfTtcbiAgICBvblVwZGF0ZSgpO1xuICAgIHJldHVybiBkb21FbGVtO1xufTtcbmNvbnN0IGRvbUVsZW0gPSBzZXR1cCgpO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb21FbGVtKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=